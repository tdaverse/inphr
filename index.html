<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Inference for Persistence Homology Data in R • inphr</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Inference for Persistence Homology Data in R">
<meta name="description" content="A set of functions for performing null hypothesis testing on samples of persistence diagrams using the theory of permutations. Currently, only two-sample testing is implemented. Inputs can be either samples of persistence diagrams themselves or vectorizations. In the former case, they are embedded in a metric space using either the Bottleneck or Wasserstein distance. In the former case, persistence data becomes functional data and inference is performed using tools available in the fdatest package.">
<meta property="og:description" content="A set of functions for performing null hypothesis testing on samples of persistence diagrams using the theory of permutations. Currently, only two-sample testing is implemented. Inputs can be either samples of persistence diagrams themselves or vectorizations. In the former case, they are embedded in a metric space using either the Bottleneck or Wasserstein distance. In the former case, persistence data becomes functional data and inference is performed using tools available in the fdatest package.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">inphr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tdaverse/inphr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="inphr">inphr<a class="anchor" aria-label="anchor" href="#inphr"></a>
</h1></div>
<!-- badges: start -->

<p>The goal of <a href="https://tdaverse.github.io/inphr/">{inphr}</a> is to provide a set of functions for performing null hypothesis testing on samples of persistence diagrams using the theory of permutations. Currently, only two-sample testing is implemented. Inputs can be either samples of persistence diagrams themselves or vectorizations. In the former case, they are embedded in a metric space using either the Bottleneck or Wasserstein distance. In the former case, persistence data becomes functional data and inference is performed using tools available in the <a href="https://permaverse.github.io/fdatest/" class="external-link">{fdatest}</a> package.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of inphr from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"tdaverse/inphr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Let us start by loading the package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tdaverse/inphr" class="external-link">inphr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="toy-data">Toy data<a class="anchor" aria-label="anchor" href="#toy-data"></a>
</h3>
<p>The package contains three toy data sets of persistence diagrams, which can be used for testing. They are available in the package as <code>trefoils1</code>, <code>trefoils2</code>, and <code>archspirals</code>. The first two sets contain persistence diagrams computed from noisy samples of trefoil knots, while the third set contains persistence diagrams computed from noisy samples of 2-armed Archimedean spirals. Each set contains 24 persistence diagrams, each computed from a sample of 120 points sampled from the respective shape, with Gaussian noise added (standard deviation = 0.05). The persistence diagrams were computed using the <a href="https://www.rdocumentation.org/packages/TDA/versions/1.9.1/topics/ripsDiag" class="external-link"><code>TDA::ripsDiag()</code></a> function with a maximum scale of 6 and up to dimension 2.</p>
</div>
<div class="section level3">
<h3 id="test-in-the-space-of-diagrams">Test in the space of diagrams<a class="anchor" aria-label="anchor" href="#test-in-the-space-of-diagrams"></a>
</h3>
<p>You can use the <a href="https://tdaverse.github.io/inphr/reference/two_sample_diagram_test.html"><code>two_sample_diagram_test()</code></a> function to perform a two-sample test on these persistence diagrams in the space of diagrams themselves. For example, to test whether the persistence diagrams from <code>trefoils1</code> are significantly different from the persistence diagrams from <code>trefoils2</code>, you can run:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/two_sample_diagram_test.html">two_sample_diagram_test</a></span><span class="op">(</span><span class="va">trefoils1</span>, <span class="va">trefoils2</span>, B <span class="op">=</span> <span class="fl">100L</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>To test whether the persistence diagrams from <code>trefoils1</code> are significantly different from the persistence diagrams from <code>archspirals</code>, you can run:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/two_sample_diagram_test.html">two_sample_diagram_test</a></span><span class="op">(</span><span class="va">trefoils1</span>, <span class="va">archspirals</span>, B <span class="op">=</span> <span class="fl">100L</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.00990099</span></span></code></pre></div>
<p>Optionnally, the <code><a href="reference/two_sample_diagram_test.html">two_sample_diagram_test()</a></code> function can also output the distribution of the test statistic under the null hypothesis as estimated by the permutation scheme. To do that, you can use the optional argument <code>keep_null_distribution = TRUE</code>. It is also possible to ask for the permutations themselves to be saved as part of the output. To do that, you can use the optional argument <code>keep_permutations = TRUE</code>.</p>
<p>Test in the space of diagrams themselves is performed using test statistics that only rely on distances between sampled diagrams. By default, two such statistics that mimic Student’s t-statistic and Fisher’s F-statistic are used as proposed in Lovato, I., Pini, A., Stamm, A., &amp; Vantini, S. (2020), <em>Model-free two-sample test for network-valued data</em>. Computational Statistics &amp; Data Analysis, <strong>144</strong>, 106896.</p>
</div>
<div class="section level3">
<h3 id="test-in-functional-spaces">Test in functional spaces<a class="anchor" aria-label="anchor" href="#test-in-functional-spaces"></a>
</h3>
<p>You can use the <a href="https://tdaverse.github.io/inphr/reference/two_sample_functional_test.html"><code>two_sample_functional_test()</code></a> function to perform a two-sample test on these persistence diagrams in functional spaces using one of five functional representations of persistence diagrams, namely: (i) Betti, (ii) Euler characteristic, (iii) normalized life, (iv) silhouette and (v) entropy curves. Computation of these functional representations is powered by the <a href="https://cran.r-project.org/package=TDAvec" class="external-link">{TDAvec}</a> package. For example, to test whether the persistence diagrams from <code>trefoils1</code> are significantly different from the persistence diagrams from <code>archspirals</code>, you can use the Betti curve representation and run:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/two_sample_functional_test.html">two_sample_functional_test</a></span><span class="op">(</span></span>
<span>  <span class="va">trefoils1</span>,</span>
<span>  <span class="va">archspirals</span>,</span>
<span>  representation <span class="op">=</span> <span class="st">"betti"</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">100L</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The output is a length-4 list. The first two elements are <code>xfd</code> and <code>yfd</code> which are numeric matrices storing evaluations of the functional representation of the diagrams on a grid stored as the third element <code>scale_seq</code>. You can therefore have a look at the functional data that the function produced using something like:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span></span>
<span>  <span class="va">out</span><span class="op">$</span><span class="va">scale_seq</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">xfd</span>, <span class="va">out</span><span class="op">$</span><span class="va">yfd</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">trefoils1</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">archspirals</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="100%"></p>
<p>In the case of testing in functional spaces, {inphr} uses the interval-wise testing (IWT) procedure powered by the <a href="https://cran.r-project.org/package=fdatest" class="external-link">{fdatest}</a> package which has been proposed in Pini, A., &amp; Vantini, S. (2017), <em>Interval-wise testing for functional data</em>. Journal of Nonparametric Statistics, <strong>29</strong>(2), 407-424.</p>
<p>The output indicates on which portions of the scale sequence does the difference between the two samples occur, providing strong control of the familywise error rate:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">iwt</span>, xrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">scale_seq</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="100%"><img src="reference/figures/README-unnamed-chunk-8-2.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a>
</h2>
<div class="section level3">
<h3 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h3>
<p>Contributions are welcome! Please feel free to open an issue or a pull request if you have any suggestions or improvements. The package is still in its early stages, so any feedback is appreciated.</p>
<p>Please note that the {inphr} project is released with a <a href="https://contributor-covenant.org/version/2/1/CODE_OF_CONDUCT.html" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
<div class="section level3">
<h3 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h3>
<p>This project was funded by <a href="https://r-consortium.org/all-projects/2024-group-1.html#modular-interoperable-and-extensible-topological-data-analysis-in-r" class="external-link">an ISC grant from the R Consortium</a> and done in coordination with Jason Cory Brunson and with guidance from Bertrand Michel and Paul Rosen. It builds upon conversations with Mathieu Carrière and Vincent Rouvreau who are among the authors of the <a href="https://gudhi.inria.fr" class="external-link">GUDHI</a> library. Package development also benefited from the support of colleagues at the <a href="https://www.math.sciences.univ-nantes.fr" class="external-link">Department of Mathematics Jean Leray</a> and the use of equipment at <a href="https://english.univ-nantes.fr" class="external-link">Nantes University</a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/tdaverse/inphr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/tdaverse/inphr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing inphr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Aymeric Stamm <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-8725-3654" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://app.codecov.io/gh/tdaverse/inphr" class="external-link"><img src="https://codecov.io/gh/tdaverse/inphr/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/tdaverse/inphr/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/tdaverse/inphr/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aymeric Stamm.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
