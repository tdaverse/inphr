<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Two-sample test for diagram representation of persistence homology data — two_sample_diagram_test • inphr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Two-sample test for diagram representation of persistence homology data — two_sample_diagram_test"><meta name="description" content="This function performs a two-sample test for persistence homology data using
the theory of permutation hypothesis testing to test the null hypothesis that
the two samples come from the same distribution. The inference is performed
using test statistics that only involve distances between persistence diagrams.
Hence, the input data can be either a persistence set or a precomputed
distance matrix."><meta property="og:description" content="This function performs a two-sample test for persistence homology data using
the theory of permutation hypothesis testing to test the null hypothesis that
the two samples come from the same distribution. The inference is performed
using test statistics that only involve distances between persistence diagrams.
Hence, the input data can be either a persistence set or a precomputed
distance matrix."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">inphr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tdaverse/inphr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Two-sample test for diagram representation of persistence homology data</h1>
      <small class="dont-index">Source: <a href="https://github.com/tdaverse/inphr/blob/main/R/two-sample-diagram-test.R" class="external-link"><code>R/two-sample-diagram-test.R</code></a></small>
      <div class="d-none name"><code>two_sample_diagram_test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs a two-sample test for persistence homology data using
the theory of permutation hypothesis testing to test the null hypothesis that
the two samples come from the same distribution. The inference is performed
using test statistics that only involve distances between persistence diagrams.
Hence, the input data can be either a persistence set or a precomputed
distance matrix.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">two_sample_diagram_test</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  dimension <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  stat_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">flipr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/flipr/man/two-sample-stats.html" class="external-link">stat_t_ip</a></span>, <span class="fu">flipr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/flipr/man/two-sample-stats.html" class="external-link">stat_f_ip</a></span><span class="op">)</span>,</span>
<span>  npc <span class="op">=</span> <span class="st">"tippett"</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keep_null_distribution <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keep_permutations <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code>persistence_set</code> typically produced by
<code><a href="https://tdaverse.github.io/phutil/reference/persistence-set.html" class="external-link">phutil::as_persistence_set()</a></code> or of class <code>dist</code> typically produced by
<code><a href="https://tdaverse.github.io/phutil/reference/pairwise-distances.html" class="external-link">phutil::bottleneck_pairwise_distances()</a></code> or
<code><a href="https://tdaverse.github.io/phutil/reference/pairwise-distances.html" class="external-link">phutil::wasserstein_pairwise_distances()</a></code>. If <code>x</code> is a persistence set,
then <code>y</code> must be either a vector of two integers (sample sizes) or another
persistence set. If <code>x</code> is a distance matrix, then <code>y</code> must be a vector of
two integers (sample sizes).</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>An object of class <code>persistence_set</code> typically produced by
<code><a href="https://tdaverse.github.io/phutil/reference/persistence-set.html" class="external-link">phutil::as_persistence_set()</a></code> or a vector of two integers. If <code>x</code> is a
persistence set, then <code>y</code> must be either a vector of two integers (sample
sizes) or another persistence set. If <code>x</code> is a distance matrix, then <code>y</code>
must be a vector of two integers (sample sizes).</p></dd>


<dt id="arg-dimension">dimension<a class="anchor" aria-label="anchor" href="#arg-dimension"></a></dt>
<dd><p>An integer value specifying the homology dimension to use.
Defaults to <code>0L</code>, which corresponds to the 0-dimensional homology.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>An integer value specifying the p-norm to use for the Wasserstein
distance. Defaults to <code>2L</code>, which corresponds to the Euclidean distance. If
<code>p</code> is set to <code>Inf</code>, then the Bottleneck distance is used.</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>An integer value specifying the number of cores to use when
computing the pairwise distance matrix between all combined persistence
diagrams. Defaults to <code>1L</code>, which means that the computation is done
sequentially.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>An integer value specifying the number of permutations to use for
the permutation hypothesis test. Defaults to <code>1000L</code>.</p></dd>


<dt id="arg-stat-functions">stat_functions<a class="anchor" aria-label="anchor" href="#arg-stat-functions"></a></dt>
<dd><p>A list of functions that compute test statistics to be
used for solving the inference problem. These functions must take two
arguments: first, an object of class <code>dist</code> representing a distance matrix
and second, an integer vector specifying the indices of the data points
belonging to the first sample. Defaults to
<code>list(flipr::stat_t_ip, flipr::stat_f_ip</code>)` which are distance-based
statistics equivalent to Student's and Fisher's statistics respectively.</p></dd>


<dt id="arg-npc">npc<a class="anchor" aria-label="anchor" href="#arg-npc"></a></dt>
<dd><p>A string specifying the non-parametric combination method to use.
Choices are either <code>"tippett"</code> (default) or <code>"fisher"</code>. The former
corresponds to the Tippet's method, while the latter corresponds to
Fisher's method.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>An integer value specifying the seed for random number
generation. Defaults to <code>NULL</code> which uses current time.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A boolean value indicating whether to print some information
about the progress of the computation. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-keep-null-distribution">keep_null_distribution<a class="anchor" aria-label="anchor" href="#arg-keep-null-distribution"></a></dt>
<dd><p>A boolean specifying whether the empirical
permutation null distribution should be returned as well. Defaults to
<code>FALSE</code>.</p></dd>


<dt id="arg-keep-permutations">keep_permutations<a class="anchor" aria-label="anchor" href="#arg-keep-permutations"></a></dt>
<dd><p>A boolean specifying whether the list of sampled
permutations used to compute the empirical permutation null distribution
should be returned as well. Defaults to <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A numeric value storing the p-value from the two-sample test where
the null hypothesis is that the two samples come from the same
distribution. If one of <code>keep_null_distribution</code> or <code>keep_permutations</code> is
set to <code>TRUE</code>, then the output will be a list containing the p-value and
the null distribution (if <code>keep_null_distribution</code> is set to <code>TRUE</code>) and
the list of sampled permutations (if <code>keep_permutations</code> is set to <code>TRUE</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Lovato, I., Pini, A., Stamm, A., &amp; Vantini, S. (2020). Model-free two-sample test for network-valued data. Computational Statistics &amp; Data Analysis, 144, 106896.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">two_sample_diagram_test</span><span class="op">(</span><span class="va">trefoils1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="va">trefoils2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, B <span class="op">=</span> <span class="fl">100L</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9782132</span>
<span class="r-in"><span><span class="fu">two_sample_diagram_test</span><span class="op">(</span><span class="va">trefoils1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="va">archspirals</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, B <span class="op">=</span> <span class="fl">100L</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.008047755</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aymeric Stamm.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

