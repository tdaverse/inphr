<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Two-sample test for functional representations of persistence homology data — two_sample_functional_test • inphr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Two-sample test for functional representations of persistence homology data — two_sample_functional_test"><meta name="description" content="This function performs a two-sample test for persistence homology data using
the theory of permutation hypothesis testing to test the null hypothesis that
the two samples come from the same distribution. The input data must be objects
of class persistence_set typically produced by phutil::as_persistence_set()."><meta property="og:description" content="This function performs a two-sample test for persistence homology data using
the theory of permutation hypothesis testing to test the null hypothesis that
the two samples come from the same distribution. The input data must be objects
of class persistence_set typically produced by phutil::as_persistence_set()."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">inphr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tdaverse/inphr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Two-sample test for functional representations of persistence homology data</h1>
      <small class="dont-index">Source: <a href="https://github.com/tdaverse/inphr/blob/main/R/two-sample-functional-test.R" class="external-link"><code>R/two-sample-functional-test.R</code></a></small>
      <div class="d-none name"><code>two_sample_functional_test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs a two-sample test for persistence homology data using
the theory of permutation hypothesis testing to test the null hypothesis that
the two samples come from the same distribution. The input data must be objects
of class <code>persistence_set</code> typically produced by <code><a href="https://tdaverse.github.io/phutil/reference/persistence-set.html" class="external-link">phutil::as_persistence_set()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">two_sample_functional_test</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  dimension <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  scale_size <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  representation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"betti"</span>, <span class="st">"euler"</span>, <span class="st">"life"</span>, <span class="st">"silhouette"</span>, <span class="st">"entropy"</span><span class="op">)</span>,</span>
<span>  mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  order <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  nknots <span class="op">=</span> <span class="va">scale_size</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  paired <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code>persistence_set</code> typically produced by
<code><a href="https://tdaverse.github.io/phutil/reference/persistence-set.html" class="external-link">phutil::as_persistence_set()</a></code> specifying the first sample.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>An object of class <code>persistence_set</code> typically produced by
<code><a href="https://tdaverse.github.io/phutil/reference/persistence-set.html" class="external-link">phutil::as_persistence_set()</a></code> specifying the second sample.</p></dd>


<dt id="arg-dimension">dimension<a class="anchor" aria-label="anchor" href="#arg-dimension"></a></dt>
<dd><p>An integer value specifying the homology dimension to use.
Defaults to <code>0L</code>, which corresponds to the 0-dimensional homology.</p></dd>


<dt id="arg-scale-size">scale_size<a class="anchor" aria-label="anchor" href="#arg-scale-size"></a></dt>
<dd><p>An integer value specifying the number of scale values to
use for the functional representation. Defaults to <code>100L</code>.</p></dd>


<dt id="arg-representation">representation<a class="anchor" aria-label="anchor" href="#arg-representation"></a></dt>
<dd><p>A string specifying the functional representation to
use. Choices are <code>"betti"</code>, <code>"euler"</code>, <code>"life"</code>, <code>"silhouette"</code>, and
<code>"entropy"</code>. Defaults to <code>"betti"</code>.</p></dd>


<dt id="arg-mu">mu<a class="anchor" aria-label="anchor" href="#arg-mu"></a></dt>
<dd><p>The difference between the first functional population and the second functional population under the null hypothesis. Either a constant (in this case, a constant function is used) or a <code>J</code>-dimensional vector containing the evaluations on the same grid which <code>data</code> are evaluated. The default is <code>mu=0</code>.</p></dd>


<dt id="arg-order">order<a class="anchor" aria-label="anchor" href="#arg-order"></a></dt>
<dd><p>Order of the B-spline basis expansion. The default is <code>order=2</code>.</p></dd>


<dt id="arg-nknots">nknots<a class="anchor" aria-label="anchor" href="#arg-nknots"></a></dt>
<dd><p>An integer value specifying the number of knots to use for the
B-spline representation. Defaults to <code>scale_size</code>.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>An integer value specifying the number of permutations to use for
the permutation hypothesis test. Defaults to <code>1000L</code>.</p></dd>


<dt id="arg-paired">paired<a class="anchor" aria-label="anchor" href="#arg-paired"></a></dt>
<dd><p>A logical indicating whether the test is paired. The default is <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A length-4 list containing the following objects:</p><ul><li><p><code>xfd</code>: A numeric matrix of shape \(n_1 \times p\) storing the
representation of the first sample on a uniform grid.</p></li>
<li><p><code>yfd</code>: A numeric matrix of shape \(n_2 \times p\) storing the
representation of the second sample on a uniform grid.</p></li>
<li><p><code>scale_seq</code>: A numeric vector of shape \(p\) storing the scale sequence
used for the functional representation.</p></li>
<li><p><code>iwt</code>: An object of class <code>ITP2</code> which is a list containing at least the
following components:</p><ul><li><p><code>basis</code>: A string indicating the basis used for the first phase of the algorithm. In this case, equals to <code>"B-spline"</code>.</p></li>
<li><p><code>test</code>: A string indicating the type of test performed. In this case, equals to <code>"2pop"</code>.</p></li>
<li><p><code>mu</code>: The difference between the mean of the first and second populations under the null hypothesis (as entered by the user).</p></li>
<li><p><code>paired</code>: A boolean value indicating whether the two samples are paired or not (as entered by the user).</p></li>
<li><p><code>coeff</code>: A numeric matrix of shape \(n \times p\) of the \(p\) coefficients of the B-spline basis expansion, with \(n = n_1 + n_2\). Rows are associated to units and columns to the basis index. The first \(n_1\) rows report the coefficients of the first population units and the following \(n_2\) rows report the coefficients of the second population units.</p></li>
<li><p><code>pval</code>: A numeric vector of shape \(p\) storing the <strong>uncorrected</strong> p-values for each coefficient of the B-spline basis expansion.</p></li>
<li><p><code>pval.matrix</code>: A numeric matrix of shape \(p \times p\) of the p-values of the multivariate tests. The element \((i, j)\) of the <code>pval.matrix</code> matrix contains the p-value of the joint NPC test of the components \((j, j+1, \dots, j+(p-i))\).</p></li>
<li><p><code>corrected.pval</code>: A numeric vector of shape \(p\) storing the <strong>corrected</strong> p-values for each coefficient of the B-spline basis expansion.</p></li>
<li><p><code>labels</code>: A character vector of shape \(n\) storing the membership of each unit to the first or second population.</p></li>
<li><p><code>data.eval</code>: A numeric matrix of shape \(n \times p\) storing the evaluation of the functional data on a uniform grid.</p></li>
<li><p><code>heatmap.matrix</code>: A numeric matrix storing the p-values. Used only for plots.</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Pini, A., &amp; Vantini, S. (2017). Interval-wise testing for functional data. Journal of Nonparametric Statistics, 29(2), 407-424.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">two_sample_functional_test</span><span class="op">(</span><span class="va">trefoils1</span>, <span class="va">archspirals</span>, B <span class="op">=</span> <span class="fl">100L</span>, scale_size <span class="op">=</span> <span class="fl">50L</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "First step: basis expansion"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Swapping 'y' and 'argvals', because 'y' is  simpler,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   and 'argvals' should be;  now  dim(argvals) =  49 ;  dim(y) =  49 x 48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Second step: joint univariate tests"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Third step: interval-wise combination and correction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 2 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 3 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 4 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 5 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 6 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 7 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 8 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 9 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 10 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 11 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 12 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 13 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 14 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 15 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 16 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 17 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 18 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 19 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 20 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 21 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 22 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 23 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 24 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 25 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 26 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 27 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 28 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 29 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 30 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 31 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 32 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 33 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 34 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 35 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 36 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 37 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 38 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 39 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 40 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 41 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 42 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 43 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 44 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 45 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 46 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 47 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 48 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "creating the p-value matrix: end of row 49 out of 49"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Interval Testing Procedure completed"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">iwt</span>, xrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">scale_seq</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="two_sample_functional_test-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="two_sample_functional_test-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">out</span><span class="op">$</span><span class="va">scale_seq</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">xfd</span>, <span class="va">out</span><span class="op">$</span><span class="va">yfd</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"l"</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">trefoils1</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">archspirals</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="two_sample_functional_test-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aymeric Stamm.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

